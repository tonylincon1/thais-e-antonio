<!DOCTYPE html>
<html lang="zxx">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Thais e Ant√¥nio</title>
    <meta name="keywords" content="keywords"/>
    <meta name="description" content="description"/>
    
    <!-- Mobile Specific Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0"/>
    
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/ico" href="img/favicon_wedding.ico"/>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Italianno&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Display&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Arapey&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Prata&display=swap" rel="stylesheet"/>

    <link href="https://fonts.googleapis.com/css?family=Lora&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Marcellus&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,700&amp;display=swap" rel="stylesheet"/>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/libs.min.css"/>
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-material-design@4.1.1/dist/css/bootstrap-material-design.min.css" integrity="sha384-wXznGJNEXNG1NFsbm0ugrLFMQPWswR3lds2VeinahP8N0zJw9VWSopbjv2x7WCvX" crossorigin="anonymous"/>
    <link rel="stylesheet" href="css/main.css"/>
    <!--<![endif]-->
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  </head>
  <body>
  
  	<!-- Menu mobile -->
    <nav class="mobile-menu bg--colored">
      <button class="mobile-menu__close"></button>
      <ul class="navigation__list mobile-navigation__list">
        <li class="navigation__item mobile-navigation__item"><a class="mobile-navigation__link" href="#">Inicio</a></li>
        <li class="navigation__item mobile-navigation__item"><a class="mobile-navigation__link" href="#couple">Casal</a></li>
        <li class="navigation__item mobile-navigation__item"><a class="mobile-navigation__link" href="#story">Nossa hist√≥ria</a></li>
        <!-- <li class="navigation__item mobile-navigation__item"><a class="mobile-navigation__link" href="#photos">Fotos</a></li> -->
        <li class="navigation__item mobile-navigation__item"><a class="mobile-navigation__link" href="#quiz-do-casal">Quiz</a></li>
        <li class="navigation__item mobile-navigation__item"><a class="mobile-navigation__link" href="#venues">Local</a></li>
        <li class="navigation__item mobile-navigation__item"><a class="mobile-navigation__link" href="#presents">Presentes</a></li>
      </ul>
    </nav>
  	<!-- END Menu mobile -->
  	
  	<!-- Header -->
    <header class="header">
      <div class="container">
        <nav class="header__nav">
          <div class="logo"><img class="img-responsive logo-image" src="img/header/logo.png" alt="Logo"/></div>
          <ul class="header__menu">
            <li class="header__menu-item"><a class="header__menu-link" href="index.html">Inicio</a></li>
            <li class="header__menu-item"><a class="header__menu-link" href="#couple">Casal</a></li>
            <li class="header__menu-item"><a class="header__menu-link" href="#story">Nossa hist√≥ria</a></li>
            <!-- <li class="header__menu-item"><a class="header__menu-link" href="#photos">Fotos</a></li> -->
            <li class="header__menu-item"><a class="header__menu-link" href="#quiz-do-casal">Quiz</a></li>
            <li class="header__menu-item"><a class="header__menu-link" href="#venues">Local</a></li>
            <li class="header__menu-item"><a class="header__menu-link" href="#presents">Presentes</a></li>
          </ul>
          <div class="header__user-actions">
            <div class="user-action user-action--hidden"><a class="mobile-menu-btn" href="#">Menu</a></div>
            <div class="user-action"><a class="rvsp-btn" href="#rvsp">Rvsp</a></div>
          </div>
        </nav>
        <div class="header__content">
          <div class="header__title-wrapper">
            <h1 class="header__title">Tha√≠s &amp; Ant√¥nio</h1><span class="header__subtitle">Casam em <br> 15 de Novembro, 2024</span>
          </div>
        </div>
        <div class="header__countdown">
          <p class="countdown__title text--colored">Contagem Regressiva üñ§</p>
          <div class="countdown__block countdown">
              <div class="countdown__element countdown__days border--colored">
                  <span class="count days text--colored">00</span>
                  <span class="label days_ref text--colored">Dias</span>
              </div>
              <div class="countdown__element countdown__hours border--colored">
                  <span class="count hours text--colored">00</span>
                  <span class="label hours_ref text--colored">Horas</span>
              </div>
              <div class="countdown__element countdown__minutes border--colored">
                  <span class="count minutes text--colored">00</span>
                  <span class="label minutes_ref text--colored">Minutos</span>
              </div>
              <div class="countdown__element countdown__seconds border--colored">
                  <span class="count seconds text--colored">00</span>
                  <span class="label seconds_ref text--colored">Segundos</span>
              </div>
          </div>
      </div>      
      </div>
    </header>
  	<!-- END Header -->
  	
  	<!-- Section: Couple -->
    <section class="couple" id="couple">
      <div class="container">
        <div class="couple__groom">
          <div class="couple__image couple__image-groom--left border--colored"></div>
          <div class="couple__text couple__text--right">
            <div class="couple__text-head text--colored">
              <h3 class="couple__title text--colored">Tha√≠s</h3><span class="couple__subtitle text--colored">Noiva</span>
            </div>
            <div class="couple__text-body">
              <p class="couple__descr">A nossa hist√≥ria come√ßou sem drama, sem ‚Äúamor √† primeira vista‚Äù. Foram poucos encontros at√© que o caso fosse interrompido pela dist√¢ncia. O que, para minha supresa, n√£o foi suficiente para nos afastar. E em um dia comum, separados por 5.000 km, percebi que n√£o havia dist√¢ncia no mundo que impedisse essa hist√≥ria de acontecer. </p>
              <p class="couple__descr">√â claro que quando eu voltei, foi preciso alguns dias de adapta√ß√£o, mas o importante √© que eu garanti que ele n√£o passasse mais nenhum carnaval solteiro.</p>
            </div>
          </div>
        </div>
        <div class="couple__bride">
          <div class="couple__image couple__image-bride--right border--colored"></div>
          <div class="couple__text couple__text--left">
            <div class="couple__text-head text--colored">
              <h3 class="couple__title text--colored">Ant√¥nio</h3><span class="couple__subtitle text--colored">Noivo</span>
            </div>
            <div class="couple__text-body">
              <p class="couple__descr">I bumped into Diana again 7 years later in a club, she had literally just returned from a holiday and was out celebrating her birthday. I was back from sea for 4 days before I left again for a few months. The probability that this would happen is crazy and to top it all off, she remembered my name.</p>
              <p class="couple__descr">I got this amazing feeling as soon as I saw her and it lives with me every day and I promise that the bunny outfit had nothing to do with it. Needless to say it turned into a very expensive night out</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  	<!-- END Section: Couple -->
  	
  	<!-- Section: Story -->
    <section class="story" id="story">
      <div class="container">
        <h2 class="s-title text--colored"> Nossa Hist√≥ria</h2>
        <div class="story__slider">
          <div class="story__slide">
            <div class="story__slider-image"><img class="story__slider-image img-responsive" src="http://placehold.it/576x440" alt="Photo"/></div>
            <div class="story__slider-text">
              <div class="slider__head-text text--colored"> 
                <h3 class="couple__title text--colored"> Como nos conhecemos</h3>
              </div>
              <p class="story__slider-descr">Em 2019, os dois estudavam engenharia de produ√ß√£o na UNIT mas em turmas diferentes. Eis que surgem duas vagas de est√°gio em um setor da universidade. Tha√≠s e sua amiga Amanda se inscreveram com a certeza que as vagas eram das duas. Elas s√≥ n√£o contavam que tinha outra dupla com a mesma certeza, eram Tony e Charlys. Ironia ou destino, as vagas foram para Thais e Tony, que foram apresentados e mal sabiam o que estava por vir...</p>
            </div>
          </div>
          <div class="story__slide">
            <div class="story__slider-image"><img class="img-responsive" src="http://placehold.it/576x440" alt="Photo"/></div>
            <div class="story__slider-text">
              <div class="slider__head-text">
                <h3 class="couple__title">Nosso primeiro encontro</h3>
              </div>
              <p class="story__slider-descr">Ap√≥s alguns meses de trabalho e DMs, Tha√≠s deu o primeiro passo e intimou "me chama pra um date". Tony que n√£o √© besta, j√° marcou logo. Eles foram na saudosa hamburgueria Chapada Burguer. Tha√≠s lembra do frio na barriga ao sair de casa pra buscar ele, enquanto Tony nervoso imaginava se ela queria o mesmo que ele ou era uma sa√≠da s√≥ na amizade. O primeiro beijo n√£o aconteceu nesse dia, mas foi ali que nasceu o brilhinho entre os dois.</p>
            </div>
          </div>
          <div class="story__slide">
            <div class="story__slider-image"><img class="img-responsive" src="http://placehold.it/576x440" alt="Photo"/></div>
            <div class="story__slider-text">
              <div class="slider__head-text">
                <h3 class="couple__title">O namoro</h3>
              </div>
              <p class="story__slider-descr">Em 2020, ao voltar do interc√¢mbio, Tha√≠s sabia que precisava viver uma hist√≥ria com Tony. Alguns dias antes do carnaval, ele foi pego de surpresa com o pedido de namoro, travou de um jeito que n√£o sabia nem falar, mas a felicidade expressada pelos dois respondeu por si s√≥. Com um m√™s, veio a pandemia e mudou toda a din√¢mica do relacionamento que estava apenas come√ßando. Em 2022, eles j√° passavam a semana toda juntos e Tha√≠s passou a visitar a casa da m√£e aos finais de semana.</p>
            </div>
          </div>
          <div class="story__slide">
            <div class="story__slider-image"><img class="img-responsive" src="img/Fazendo dos lim√µes uma limonada.jpeg" alt="Photo"/></div>
            <div class="story__slider-text">
              <div class="slider__head-text">
                <h3 class="couple__title">Fazendo dos lim√µes uma limonada</h3>
              </div>
              <p class="story__slider-descr">Em 2022, movidos pela vontade de conhecer outro lugar e aproveitar o modelo de trabalho home office dos dois, eles moraram em Buenos Aires por dois meses. Foi a viagem dos sonhos para o casal. Tha√≠s apresentou os lugares que visitou, eles conheceram lugares novos juntos, passaram perrengue. A intimidade e amor s√≥ crescia, at√© que no √∫ltimo date da viagem antes de voltar ao Brasil, aconteceu a conversa esperada. Eles estavam pronto para dar o pr√≥ximo passo.</p>
            </div>
          </div>
          <div class="story__slide">
            <div class="story__slider-image"><img class="img-responsive" src="img/O pedido de casamento.jpeg" alt="Photo"/></div>
            <div class="story__slider-text">
              <div class="slider__head-text">
                <h3 class="couple__title">O pedido de casamento</h3>
              </div>
              <p class="story__slider-descr">.</p>
            </div>
          </div>
        </div>
      </div>
    <style>
      .story__slider-image img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        max-width: 576px;
        max-height: 440px;
      }
    </style>
    </section>
  	<!-- END Section: Story -->
  	
  	<!-- Section: Photos -->
    <!-- <section class="photos" id="photos">
      <h2 class="s-title text--colored">Fotos</h2>
      <div class="swiper-container">
        <div class="photos__slider swiper-wrapper">
          <div class="photo swiper-slide"><a class="fancy" href="http://placehold.it/960x1224" data-fancybox="gallery"><img class="img-responsive" src="http://placehold.it/320x480" alt="Photo"/></a></div>
          <div class="photo swiper-slide"><a class="fancy" href="http://placehold.it/960x1224" data-fancybox="gallery"><img class="img-responsive" src="http://placehold.it/320x480" alt="Photo"/></a></div>
          <div class="photo swiper-slide"><a class="fancy" href="http://placehold.it/960x1224" data-fancybox="gallery"><img class="img-responsive" src="http://placehold.it/320x480" alt="Photo"/></a></div>
          <div class="photo swiper-slide"><a class="fancy" href="http://placehold.it/960x1224" data-fancybox="gallery"><img class="img-responsive" src="http://placehold.it/320x480" alt="Photo"/></a></div>
          <div class="photo swiper-slide"><a class="fancy" href="http://placehold.it/960x1224" data-fancybox="gallery"><img class="img-responsive" src="http://placehold.it/320x480" alt="Photo"/></a></div>
          <div class="photo swiper-slide"><a class="fancy" href="http://placehold.it/960x1224" data-fancybox="gallery"><img class="img-responsive" src="http://placehold.it/320x480" alt="Photo"/></a></div>
        </div>
        <div class="buttons-container">
          <div class="swiper-button-prev arrow-left--colored-before"></div>
          <div class="swiper-pagination text--colored"> </div>
          <div class="swiper-button-next arrow-right--colored-before"></div>
        </div>
      </div>
    </section> -->
  	<!-- END Section: Photos -->

    <!-- Section: Quiz do Casal -->
    <section class="quiz-do-casal" id="quiz-do-casal">
      <div class="container">
        <div class="quiz__ranking-wrap">
          <h2 class="s-title text--colored">Quiz do Casal</h2>
          <table class="quiz__table">
            <thead>
              <tr>
                <th><strong>Posi√ß√£o</strong></th>
                <th><strong>Participante</strong></th>
                <th><strong>Pontos (m√°x. √© 12)</strong></th>
                <th><strong>Data e Hora</strong></th>
              </tr>
            </thead>
            <tbody id="ranking-table">
              <!-- O ranking ser√° preenchido via script -->
            </tbody>
          </table>
          <div class="quiz__btn-wrap">
            <button class="quiz__btn btn bg--colored" id="start-quiz">Responder Quiz</button>
          </div>
        </div>
      </div>

      <!-- Popup para o Quiz -->
      <div class="popup" id="quiz-popup" style="display: none;">
        <div class="popup__content scrollable-popup">
          <h3>Responda o Quiz</h3>
          <form id="quiz-form">
            <!-- Campo obrigat√≥rio para nome -->
            <div class="form-group">
              <label class="bmd-label-floating" for="nome">Nome</label>
              <input class="form-control" type="text" id="nome" required/>
            </div>
            
            <!-- Perguntas do quiz -->
            <div class="question">
              <label>1. Como Tha√≠s e Tony se conheceram?</label>
              <input type="radio" name="q1" value="b" required> No trabalho como estagi√°rios na universidade<br>
              <input type="radio" name="q1" value="a"> Em um encontro de amigos<br>
              <input type="radio" name="q1" value="c"> Durante um interc√¢mbio<br>
              <input type="radio" name="q1" value="d"> Em um evento de engenharia
            </div>

            <div class="question">
              <label>2. Onde foi o primeiro encontro de Tha√≠s e Tony?</label>
              <input type="radio" name="q2" value="c" required> Na hamburgueria Chapada Burguer<br>
              <input type="radio" name="q2" value="a"> No cinema<br>
              <input type="radio" name="q2" value="b"> Em uma pizzaria<br>
              <input type="radio" name="q2" value="d"> Em uma cafeteria
            </div>

            <div class="question">
              <label>3. Qual foi o momento que marcou o in√≠cio do namoro de Tha√≠s e Tony?</label>
              <input type="radio" name="q3" value="b" required> Ap√≥s um pedido de namoro inesperado de Tha√≠s antes do carnaval<br>
              <input type="radio" name="q3" value="a"> Durante uma viagem para Buenos Aires<br>
              <input type="radio" name="q3" value="c"> Depois do primeiro beijo<br>
              <input type="radio" name="q3" value="d"> Durante uma festa de amigos
            </div>

            <div class="question">
              <label>4. Como a pandemia impactou o relacionamento de Tha√≠s e Tony?</label>
              <input type="radio" name="q4" value="b" required> Mudou a din√¢mica do relacionamento que estava apenas come√ßando<br>
              <input type="radio" name="q4" value="a"> Eles passaram a se ver menos<br>
              <input type="radio" name="q4" value="c"> Eles decidiram terminar<br>
              <input type="radio" name="q4" value="d"> Eles se mudaram juntos para outra cidade
            </div>

            <div class="question">
              <label>5. Qual cidade o casal decidiu morar temporariamente em 2022?</label>
              <input type="radio" name="q5" value="b" required> Buenos Aires<br>
              <input type="radio" name="q5" value="a"> Nova York<br>
              <input type="radio" name="q5" value="c"> Paris<br>
              <input type="radio" name="q5" value="d"> Lisboa
            </div>

            <div class="question">
              <label>6. Qual foi o "pr√≥ximo passo" que Tha√≠s e Tony decidiram dar ao final da viagem para Buenos Aires?</label>
              <input type="radio" name="q6" value="a" required> Casamento<br>
              <input type="radio" name="q6" value="b"> Compra de uma casa<br>
              <input type="radio" name="q6" value="c"> Ter um filho<br>
              <input type="radio" name="q6" value="d"> Fazer uma nova viagem juntos
            </div>

            <button class="popup__btn btn bg--colored" type="submit">Enviar Respostas</button>
          </form>
        </div>
      </div>

      <!-- Popup para Exibir a Nota -->
      <div class="popup" id="result-popup" style="display: none;">
        <div class="popup__content">
          <h3>Resultado</h3>
          <p>Sua nota: <span id="final-score"></span></p>
          <button class="popup__btn btn bg--colored" onclick="closeResultPopup()">Fechar</button>
        </div>
      </div>
    </section>

    <script>
      const scriptUrl = 'https://script.google.com/macros/s/AKfycbwfeQF-lMkMdAhr9qu8wWwDydVzVeWSbJ98RlT_wwNP8DHPK6U1uCItWqfuZqXsHJTL/exec';

      function loadRanking() {
        let fullUrl = scriptUrl + '?action=quizCasalRanking'; // Adiciona o par√¢metro action

        fetch(fullUrl)
          .then(response => response.json())
          .then(data => {
            let rankingTable = document.getElementById('ranking-table');
            rankingTable.innerHTML = '';

            data.forEach((entry, index) => {
              let row = document.createElement('tr');
              let formattedDate = new Date(entry.dataHora).toLocaleString('pt-BR', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
              });

              let medal = '';
              if (index === 0) medal = 'ü•á';
              else if (index === 1) medal = 'ü•à';
              else if (index === 2) medal = 'ü•â';

              row.innerHTML = `
                <td>${medal || (index + 1)}</td>
                <td>${entry.participante}</td>
                <td>${entry.nota}</td>
                <td>${formattedDate}</td>
              `;
              
              if (index < 3) row.classList.add('podium');
              rankingTable.appendChild(row);
            });
          })
          .catch(error => console.error('Erro ao carregar o ranking:', error));
      }

      document.getElementById('start-quiz').addEventListener('click', function() {
        document.getElementById('quiz-popup').style.display = 'inline-flex';
      });

      document.getElementById('quiz-form').addEventListener('submit', function(e) {
        e.preventDefault();

        let nomeValue = document.getElementById('nome').value;
        
        let formData = new FormData(e.target);
        let quizData = {
          action: 'quizCasal',
          nome: nomeValue,
          q1: formData.get('q1'),
          q2: formData.get('q2'),
          q3: formData.get('q3'),
          q4: formData.get('q4'),
          q5: formData.get('q5'),
          q6: formData.get('q6')
        };

        fetch(scriptUrl, {
          method: 'POST',
          body: JSON.stringify(quizData),
        })
        .then(response => response.json())
        .then(result => {
          document.getElementById('final-score').textContent = result.nota;
          document.getElementById('quiz-popup').style.display = 'none';
          document.getElementById('result-popup').style.display = 'inline-flex';
          loadRanking();
        })
        .catch(error => console.error('Erro ao enviar o quiz:', error));
      });

      function closeResultPopup() {
        document.getElementById('result-popup').style.display = 'none';
      }

      window.onload = loadRanking;

    </script>

    <style>
      section#quiz-do-casal {
          padding-top: 7%;
      }

      .quiz__table {
        width: 100%;
        border-collapse: collapse;
      }

      .quiz__table th, .quiz__table td {
        padding: 10px;
        text-align: center;
      }

      .quiz__btn-wrap {
        text-align: center;
        margin-top: 20px;
        display: flex;
        justify-content: center;
      }

      .popup {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
      }

      .popup__content {
        background: #fff;
        padding: 20px;
        border-radius: 10px;
        width: 70%;
        max-width: 600px;
      }

      .form-group {
        margin-bottom: 15px;
      }

      .form-group label {
        display: block;
        font-weight: bold;
      }

      .question {
        margin-bottom: 15px;
      }

      .question label {
        font-weight: bold;
        display: block;
      }

      .popup__btn {
        display: block;
        margin: 0 auto;
        padding: 10px 20px;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
      }

      .podium {
        font-weight: bold;
        background-color: #f0f0f0;
      }

      /* Estilo b√°sico para o popup com rolamento */
      .scrollable-popup {
        max-height: 80vh; /* Limita a altura m√°xima do popup */
        overflow-y: auto; /* Adiciona barra de rolagem vertical se necess√°rio */
      }
    </style>
    <!-- END Section: Quiz -->

  	<!-- Section: Venues -->
    <section class="venues" id="venues">
      <div class="container">
        <h2 class="s-title text--colored"> Local</h2>
        <div class="container-sm">
          <div class="venues__ceremony">
            <div class="ceremony__card venues__card border--colored">
              <div class="venues__card-head text--colored"> 
                <h3 class="venues__card-title text--colored"> Cerim√¥nia e Festa</h3>
              </div>
              <div class="venues__card-info">
                <div class="venues__card-block"><span class="venues__card-label mrg">Quando</span>
                  <time class="venues__card-data">18:00, 15/11/2024</time>
                </div>
                <div class="venues__card-block"><span class="venues__card-label">Onde</span><span class="venue__card-data">Espa√ßo Villa Ricca. <br> Av. Dr. Walter Bastos, 144 - Mosqueiro, Aracaju - SE</span></div>
              </div><a class="venues__card-link" href="#">Veja no mapa</a>
            </div>
            <div class="address__map-container--left address__map">
              <div class="address__map--ceremony map" id="address__map--ceremony"></div>
            </div>
          </div>
        </div>
      </div>
    </section>
  	<!-- END Section: Venues -->
  	
  	<!-- Section: RSVP -->
    <section class="rvsp" id="rvsp">
      <div class="container">
        <div class="rvsp__forrm-wrap">
          <form class="rvsp__form" action="" method="POST">
            <h2 class="rvsp__title text--colored">RVSP</h2>
            <span class="rvsp__subtitle text--colored">Por favor, confirme sua presen√ßa at√© o dia <strong>01 de Novembro de 2024</strong></span>
            <div class="rvsp__inputs-group">
              <div class="form-group iputs__group">
                <label class="bmd-label-floating" for="name">Nome</label>
                <input class="form-control" type="text" id="name" required/>
              </div>
              <div class="form-group iputs__group">
                <label class="bmd-label-floating" for="mail">E-mail</label>
                <input class="form-control" type="email" id="mail" required/>
              </div>
            </div>
            <div class="rvsp__inputs-group">
              <div class="form-group iputs__group">
                <label class="bmd-label-floating" for="telefone">Telefone</label>
                <input class="form-control" type="tel" id="telefone" required/>
              </div>
              <div class="form-group iputs__group form-group--select">
                <div class="form__select select--clicked">
                  <span class="select__label">Confirmo presen√ßa</span>
                  <span class="selected__item" required></span>
                  <div class="select-dropdown">
                    <span class="dropdown__select">Sim</span>
                    <span class="dropdown__select">N√£o</span>
                    <span class="dropdown__select">N√£o tenho certeza</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="rvsp__inputs-group rvsp__group--textarea">
              <div class="form-group">
                <label class="bmd-label-floating" for="textarea">Mande sua mensagem para os noivos</label>
                <textarea class="rvsp__textarea form-control" id="textarea"></textarea>
              </div>
            </div>
            <button class="rvsp__btn btn bg--colored" type="submit">Confirmar presen√ßa</button>
          </form>
        </div>
      </div>
    </section>

    <script>
      document.querySelector('.rvsp__form').addEventListener('submit', function(e) {
        e.preventDefault(); // Evita o comportamento padr√£o do form

        var currentDateTime = new Date();
        var dateTime = currentDateTime.toLocaleDateString() + ' ' + currentDateTime.toLocaleTimeString();

        // Coleta os dados do formul√°rio
        var data = {
          action: 'confirmPresence',
          name: document.getElementById('name').value,
          email: document.getElementById('mail').value,
          phone: document.getElementById('telefone').value,
          presence: document.querySelector('.selected__item').textContent || 'N√£o informado',
          message: document.getElementById('textarea').value,
          dateTime: dateTime
        };

        // Verifica se os campos obrigat√≥rios est√£o preenchidos
        if (!data.name || !data.email || !data.phone || data.presence === 'N√£o informado') {
          Swal.fire({
            icon: 'warning',
            title: 'Ops...',
            text: 'Por favor, preencha todos os campos obrigat√≥rios.'
          });
          return;
        }

        // Envia os dados via POST para o Google Apps Script
        fetch(scriptUrl, {
          method: 'POST',
          mode: 'no-cors',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)
        }).then(response => {
          // Popup de sucesso com SweetAlert
          Swal.fire({
            icon: 'success',
            title: 'Confirma√ß√£o enviada!',
            text: 'Obrigado por confirmar sua presen√ßa!'
          });
        }).catch(error => {
          // Popup de erro com SweetAlert
          Swal.fire({
            icon: 'error',
            title: 'Erro!',
            text: 'Ocorreu um erro ao enviar a confirma√ß√£o. Por favor, tente novamente mais tarde.'
          });
        });
      });
    </script>
  <!-- END Section: Rvsp -->

  	
  <!-- Section: Presents -->
  <section class="presents" id="presents">
    <div class="container">
      <h2 class="s-title text--colored">Lista de Presentes</h2>
      <div id="present-list" class="present-grid">
        <!-- Presentes ser√£o carregados aqui -->
      </div>
      <div class="pagination">
        <button id="prev-page" class="btn">Anterior</button>
        <button id="next-page" class="btn">Pr√≥ximo</button>
      </div>
    </div>
  </section>

  <!-- Modal para doa√ß√£o -->
  <div id="donation-modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2 id="gift-name"></h2>
      <p>Por favor, preencha o nome e confirme sua doa√ß√£o:</p>
      <input type="text" id="donor-name" placeholder="Seu nome" required>
      <p>Dados para transfer√™ncia:</p>
      <p>Conta: 1234-5678</p>
      <button id="confirm-donation" class="btn">Confirmar Doa√ß√£o</button>
    </div>
  </div>

  <style>
    /* Estilo geral da se√ß√£o */
    .presents {
      padding: 20px 0;
      background-color: #f9f9f9;
      padding-top: 10%;
      padding-bottom: 15%;
    }

    .presents__title {
      text-align: center;
      font-size: 2rem;
      margin-bottom: 30px;
      color: #333;
    }

    /* Grid para exibir os presentes */
    .present-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr); /* Grid 3x3 para telas grandes */
      gap: 20px;
      justify-items: center;
    }

    /* Estilo das caixinhas de presentes */
    .present-box {
      width: 100%;
      max-width: 300px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 10px;
      background-color: white;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: space-between;
    }

    .present-box img {
      width: 100%;
      max-height: 200px; /* Define uma altura m√°xima fixa */
      object-fit: contain; /* A imagem √© contida na √°rea, mantendo a propor√ß√£o */
      border-radius: 5px;
      margin-bottom: 15px;
    }

    .present-box h3 {
      font-size: 1.2rem;
      margin-bottom: 10px;
      color: #333;
    }

    .present-box p {
      font-size: 1rem;
      margin-bottom: 10px;
      color: #555;
    }

    /* Estilo para presente indispon√≠vel */
    .unavailable {
      background-color: #f0f0f0;
      color: #999;
      box-shadow: none;
      opacity: 0.7;
    }

    .unavailable h3,
    .unavailable p {
      color: #999;
    }

    /* Bot√£o de presentear */
    .present-btn {
      margin-top: auto; /* Empurra o bot√£o para o final */
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
      transition: background-color 0.3s ease;
    }

    .present-btn:disabled {
      background-color: #aaa;
      cursor: not-allowed;
    }

    /* Estilo da pagina√ß√£o */
    .pagination {
      margin-top: 20px;
      text-align: center;
      padding-top: 5%;
      justify-content: center;
    }

    .pagination .btn {
      margin: 0 5px;
      padding: 10px 20px;
      background-color: #333;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 5px;
    }

    .pagination .btn:hover {
      background-color: #555;
    }

    /* Modal de doa√ß√£o */
    .modal {
      display: none;
      position: fixed;
      z-index: 1;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background-color: white;
      padding: 20px;
      border-radius: 10px;
      max-width: 500px;
      width: 100%;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .modal-content h2 {
      margin-bottom: 20px;
      font-size: 1.5rem;
      color: #333;
    }

    .modal-content input {
      padding: 10px;
      width: 80%;
      margin-bottom: 20px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }

    .modal-content .btn {
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
    }

    .close {
      position: absolute;
      right: 20px;
      top: 20px;
      font-size: 1.5rem;
      cursor: pointer;
    }

    /* Media Queries para Responsividade */

    /* Tablets (m√©dio) */
    @media (max-width: 768px) {
      .present-grid {
        grid-template-columns: repeat(2, 1fr); /* 2 colunas para telas m√©dias */
      }

      .present-box {
        max-width: 250px; /* Ajusta o tamanho do bloco */
      }
    }

    /* Celulares (pequeno) */
    @media (max-width: 480px) {
      .present-grid {
        grid-template-columns: 1fr; /* 1 coluna para telas pequenas */
      }

      .present-box {
        max-width: 70%; /* Ajusta para ocupar toda a largura dispon√≠vel */
      }

      .pagination .btn {
        padding: 10px 15px; /* Ajuste no tamanho dos bot√µes de pagina√ß√£o */
      }

      .pagination {
        padding-bottom: 15%;
      }
    }
  </style>

  <script>
    let currentPage = 1;
    const itemsPerPage = 9;
    let gifts = [];

    let fullUrl = scriptUrl + '?action=getPresents';

    // Fun√ß√£o para buscar presentes da planilha via Apps Script
    function fetchGifts() {
      fetch(fullUrl)
        .then(response => response.json())
        .then(data => {
          gifts = data;
          renderGifts(currentPage);
        })
        .catch(error => {
          console.error('Erro ao buscar presentes:', error);
          alert('Erro ao carregar a lista de presentes.');
        });
    }

    // Renderiza os presentes na p√°gina
    function renderGifts(page) {
      const presentList = document.getElementById('present-list');
      presentList.innerHTML = ''; // Limpa os presentes anteriores

      // Ordena os presentes, colocando os dispon√≠veis primeiro
      const sortedGifts = [...gifts].sort((a, b) => (a[3] === 'N√£o') - (b[3] === 'N√£o'));

      const start = (page - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const giftsToShow = sortedGifts.slice(start, end);

      giftsToShow.forEach(gift => {
        const [name, photo, value, available] = gift;
        const giftBox = document.createElement('div');
        giftBox.classList.add('present-box');

        // Verifica se o presente est√° indispon√≠vel e adiciona a classe unavailable
        if (available === 'N√£o') {
          giftBox.classList.add('unavailable');
          giftBox.innerHTML = `
            <img src="${photo}" alt="${name}">
            <h3>${name}</h3>
            <p>Valor: R$ ${value}</p>
            <p><strong>Acabou :(</strong></p>
          `;
        } else {
          giftBox.innerHTML = `
            <img src="${photo}" alt="${name}">
            <h3>${name}</h3>
            <p>Valor: R$ ${value}</p>
            <button class="btn present-btn" onclick="openDonationModal('${name}')">Presentear</button>
          `;
        }
        presentList.appendChild(giftBox);
      });

      updatePagination();
    }

    // Fun√ß√£o para atualizar o estado dos bot√µes de pagina√ß√£o
    function updatePagination() {
      const nextPageBtn = document.getElementById('next-page');
      const prevPageBtn = document.getElementById('prev-page');

      nextPageBtn.disabled = (currentPage * itemsPerPage) >= gifts.length;
      prevPageBtn.disabled = currentPage === 1;
    }

    document.getElementById('next-page').addEventListener('click', () => {
      if ((currentPage * itemsPerPage) < gifts.length) {
        currentPage++;
        renderGifts(currentPage);
      }
    });

    document.getElementById('prev-page').addEventListener('click', () => {
      if (currentPage > 1) {
        currentPage--;
        renderGifts(currentPage);
      }
    });

    // Abre o modal de doa√ß√£o
    function openDonationModal(giftName) {
      const modal = document.getElementById('donation-modal');
      modal.style.display = 'flex';
      document.getElementById('gift-name').textContent = giftName;
    }

    // Fecha o modal
    document.querySelector('.close').addEventListener('click', () => {
      document.getElementById('donation-modal').style.display = 'none';
    });

    // Fecha o modal com a tecla Esc
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        document.getElementById('donation-modal').style.display = 'none';
      }
    });

    // Confirma√ß√£o da doa√ß√£o
    document.getElementById('confirm-donation').addEventListener('click', () => {
      const donorName = document.getElementById('donor-name').value;
      const giftName = document.getElementById('gift-name').textContent;

      if (donorName) {
        fetch(scriptUrl, {
          method: 'POST',
          mode: 'no-cors',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            action: 'updateGiftStatus',
            presente: giftName,
            nomeDoador: donorName
          })
        }).then(response => {
          // Popup de sucesso com SweetAlert
          Swal.fire({
            icon: 'success',
            title: 'Presente enviado!',
            text: 'N√≥s agradecemos muito pelo mimo!'
          });
        }).catch(error => {
          // Popup de erro com SweetAlert
          Swal.fire({
            icon: 'error',
            title: 'Erro!',
            text: 'Ocorreu um erro ao enviar a confirma√ß√£o do presente. Por favor, tente novamente mais tarde.'
          });
        });
      }
    });

    // Carrega a lista de presentes ao iniciar
    fetchGifts();
  </script>

  	
  	<!-- To top botton -->
    <div class="to-top bg--colored"></div>
  	<!-- END To top botton -->
    
  	<!-- Footer -->
    <footer class="footer">
      <div class="footer__content"><span class="footer__name jeremy text--colored">Tha√≠s</span>
        <div class="footer__image"><img src="img/header/logo_media.png" alt="Photo"/></div><span class="footer__name diana text--colored">Ant√¥nio</span>
      </div>
    </footer>
  	<!-- END Footer -->
  	<!-- All JavaScript Libraries -->
    <script src="https://unpkg.com/popper.js@1.12.6/dist/umd/popper.js" integrity="sha384-fA23ZRQ3G/J53mElWqVJEGJzU0sTs+SvzG8fXVWP+kJQ1lwFAOkcUOysnlKJC33U" crossorigin="anonymous"></script>
    <script src="js/libs.min.js"></script>
    <script src="https://unpkg.com/bootstrap-material-design@4.1.1/dist/js/bootstrap-material-design.js" integrity="sha384-CauSuKpEqAFajSpkdjv3z9t8E7RlpJ1UP0lKM/+NdtSarroVKu069AlsRPKkFBz9" crossorigin="anonymous"></script>
    <!-- Yandex map -->
    <script type="text/javascript" src="https://api-maps.yandex.ru/2.1/?apikey=0a7ad2dd-daec-4dac-84d8-e01e38600600&amp;lang=en"></script>
    <!-- Custom JavaScript -->
    <script src="js/scripts.js"></script>
  </body>
</html>